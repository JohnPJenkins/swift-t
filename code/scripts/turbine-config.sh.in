
# BASH-formatted setup script processed by turbine/configure

TURBINE_HOME=@prefix@
export C_UTILS=@USE_C_UTILS@
export TCL=@USE_TCL@
export ADLB=@USE_ADLB@
# Only one of the following is used
export MPI=@USE_MPI@
export MPI_LIB=@USE_MPI_LIB_DIR@

# Should not need LD_LIBRARY_PATH: using ld -rpath
# export LD_LIBRARY_PATH=${TURBINE_HOME}/lib:${LD_LIBRARY_PATH}
# export LD_LIBRARY_PATH=${C_UTILS}/lib:${LD_LIBRARY_PATH}
# export LD_LIBRARY_PATH=${TCL}/lib:${LD_LIBRARY_PATH}
# export LD_LIBRARY_PATH=${ADLB}:${LD_LIBRARY_PATH}
# export LD_LIBRARY_PATH=${MPI}/lib:${LD_LIBRARY_PATH}
# export LD_LIBRARY_PATH=${MPI_LIB}:${LD_LIBRARY_PATH}

TCLLIBPATH=
if [[ -n ${TURBINE_USER_LIB} ]] ; then
  TCLLIBPATH="${TURBINE_USER_LIB} "
fi
TCLLIBPATH+="${TURBINE_HOME}/lib"
export TCLLIBPATH

# The default Tcl installation has executable "tclsh8.5",
# but we prefer one named "tclsh"
for tcl in ${TCL}/bin/{tclsh,tclsh8.5}
do
 if [[ -x ${tcl} ]]
   then
   export TCLSH=${tcl}
   break
 fi
done

if [[ ${TCLSH} == "" ]]
then
  echo "Could not find tclsh!"
  return 1
fi

export TURBINE_LAUNCH=@USE_LAUNCHER@
export TURBINE_MACHINE=@USE_MACHINE@

if [[ ${TURBINE_MACHINE} == "sicortex" ]]
then
  # Fast string functions for the SiCortex
  # Turbine will not run without this
  export LD_PRELOAD=/usr/lib64/libscstr.so
  # For some reason, the SiCortex cannot find this in rpath
  export LD_LIBRARY_PATH=${TURBINE_HOME}/lib:${LD_LIBRARY_PATH}
fi

return 0
